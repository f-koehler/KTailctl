#ifndef KTAILCTL_ICONS_TRAY_ICONS_TRAY_ICON_THEMES_HPP
#define KTAILCTL_ICONS_TRAY_ICONS_TRAY_ICON_THEMES_HPP

#include <QStringList>
#include <QObject>
#include <QBindable>
#include "ktailctl_config.h"

static const QStringList TrayIconThemesList = {
@KTAILCTL_TRAY_ICON_THEMES_LITERAL_LIST@
};

class TrayIconThemes : public QObject {
  Q_OBJECT
  Q_PROPERTY(QStringList themes READ themes CONSTANT)
  Q_PROPERTY(qsizetype currentIndex READ currentIndex WRITE setCurrentIndex BINDABLE bindableCurrentIndex)

  private:
    QProperty<qsizetype> mCurrentIndex;

  public:
    explicit TrayIconThemes(QObject* parent = nullptr) : QObject(parent) {
      mCurrentIndex = TrayIconThemesList.indexOf(Config::trayIconTheme());
      connect(Config::self(), &Config::trayIconThemeChanged, [this](){
      mCurrentIndex = TrayIconThemesList.indexOf(Config::trayIconTheme());
      });
    }

    [[nodiscard]] const QStringList& themes() const noexcept {
        return ::TrayIconThemesList;
    }

    [[nodiscard]] int currentIndex() const noexcept { return mCurrentIndex; }

    void setCurrentIndex(int index) {
      if(index < TrayIconThemesList.size()) {
          Config::setTrayIconTheme(TrayIconThemesList.at(index));
          Config::self()->save();
          mCurrentIndex = TrayIconThemesList.indexOf(Config::trayIconTheme());
      }
    }

    [[nodiscard]] QBindable<int> bindableCurrentIndex()
    {
        return {&mCurrentIndex};
    }
};

#endif